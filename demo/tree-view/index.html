<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Tree View</title>
    <script src="https://cdn.bootcss.com/vue/2.4.4/vue.js"></script>
    <link href="https://cdn.bootcss.com/bulma/0.6.0/css/bulma.css" rel="stylesheet">
</head>

<body>
    <style>
        body {
            font-family: "Fira Code", Consolas, monospace;
            font-size: 18px;
        }

        .bold {
            font-weight: bold;
        }

        .bold::before {
            content: "ğŸ“";
        }

        .file-item::before {
            content: "ğŸ“„";
        }

        .item {
            cursor: pointer;
        }

        ul {
            margin-left: 40px;
        }
    </style>
    <script type="text/x-template" id="item-template">
        <li>
            <div :class="{bold:isFolder,'file-item':!isFolder}" @click="toggle" @dblclick="changeType">
                {{model.name}}
                <span v-if="isFolder">[{{open ? '-' : '+'}}]</span>
            </div>
            <ul v-show="open" v-if="isFolder">
                <item class="item" v-for="model in model.children" :model="model">
                </item>
                <!-- ä½äºä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æœ«å°¾ï¼Œç”¨äºåœ¨æ­¤æ–‡ä»¶å¤¹ä¸‹æ·»åŠ æ–°æ–‡ä»¶ -->
                <li class="add" @click="addChild">+</li>
            </ul>
        </li>
    </script>
    <ul id="app">
        <item class="item" :model="treeData"></item>
    </ul>
    <script>
        //åˆå§‹åŒ–æ•°æ®ï¼Œchildreåä¸ºæ•°ç»„ï¼Œæ•°ç»„ä¸­æœ‰å¤šä¸ªå¯¹è±¡ï¼Œä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œæ–‡ä»¶å¯¹è±¡åªæœ‰ä¸€ä¸ªnameï¼Œæ–‡ä»¶å¤¹å¯¹è±¡é™¤äº†æœ‰nameè¿˜æœ‰ä¸€ä¸ªchildreï¼Œå¯¹åº”ä¹Ÿæ˜¯æ•°ç»„å³æ–‡ä»¶å¤¹ä¸‹çš„å†…å®¹
        var data = {
            name: 'My Tree',
            children: [{
                    name: 'hello'
                },
                {
                    name: 'wtf'
                },
                {
                    name: "this is a folder",
                    children: [{
                            name: 'inside the folder',
                        },
                        {
                            name: "another file"
                        }
                    ]
                }
            ]
        }
        //æ¯ä¸€ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹å°±æ˜¯ä¸€ä¸ªvueå®ä¾‹
        Vue.component('item', {
            template: '#item-template',
            props: {
                //æ¯ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„æ•°æ®ï¼Œå³æ–‡ä»¶/å¤¹åç§°ä¸æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶
                model: Object
            },
            //æ–‡ä»¶å¤¹é»˜è®¤ä¸ºå…³é—­çŠ¶æ€
            data: function () {
                return {
                    open: false
                }
            },
            computed: {
                isFolder: function () {
                    //å¯¹è±¡å­˜åœ¨ä¸”ï¼Œå¯¹è±¡ä¸‹é¢childreæ•°ç»„çš„é•¿åº¦ä¸ä¸º0ï¼Œåˆ™åˆ¤æ–­å…¶ä¸ºä¸€ä¸ªæ–‡ä»¶å¤¹
                    return this.model.children && this.model.children.length
                }
            },
            methods: {
                //æ–‡ä»¶å¤¹æ‰“å¼€å…³é—­çŠ¶æ€
                toggle: function () {
                    if (this.isFolder) {
                        this.open = !this.open
                    }
                },
                //æ”¹å˜æ–‡ä»¶ä¸ºæ–‡ä»¶å¤¹ï¼Œæ“ä½œå³ä¸ºå°†æ–‡ä»¶å¯¹è±¡ä¸‹çš„chilrenæ•°ç»„æ–°å¢ä¸€é¡¹
                changeType: function () {
                    if (!this.isFolder) {
                        //Vue.set:è®¾ç½®å¯¹è±¡çš„å±æ€§ï¼Œè¿™é‡Œå°†æ–°å»ºä¸€ä¸ªchildrenæ•°ç»„ä¸ºç©ºæ•°ç»„ï¼Œä¾›addChildæ–¹æ³•æ·»åŠ item
                        Vue.set(this.model, 'children', [])
                        this.addChild()
                        this.open = true
                    }
                },
                addChild: function () {
                    this.model.children.push({
                        name: 'new item'
                    })
                }
            }
        })
        var demo = new Vue({
            el: '#app',
            data: {
                treeData: data
            }
        })
    </script>
</body>

</html>